{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/user/webapp/lib/adminAuth.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport bcrypt from 'bcryptjs';\n\nexport async function basicAuth(request: NextRequest): Promise<NextResponse | null> {\n  const authHeader = request.headers.get('authorization');\n\n  if (!authHeader || !authHeader.startsWith('Basic ')) {\n    return new NextResponse('Authentication required', {\n      status: 401,\n      headers: {\n        'WWW-Authenticate': 'Basic realm=\"Admin Area\"',\n      },\n    });\n  }\n\n  const base64Credentials = authHeader.split(' ')[1];\n  const credentials = Buffer.from(base64Credentials, 'base64').toString('utf-8');\n  const [username, password] = credentials.split(':');\n\n  const validUsername = process.env.ADMIN_USERNAME || 'admin';\n  const validPassword = process.env.ADMIN_PASSWORD || 'admin123';\n\n  // Simple comparison for now (in production, use bcrypt comparison with DB)\n  if (username === validUsername && password === validPassword) {\n    return null; // Authentication successful\n  }\n\n  return new NextResponse('Invalid credentials', {\n    status: 401,\n    headers: {\n      'WWW-Authenticate': 'Basic realm=\"Admin Area\"',\n    },\n  });\n}\n\nexport function requireAuth<T extends any[]>(\n  handler: (request: NextRequest, ...args: T) => Promise<Response>\n) {\n  return async (request: NextRequest, ...args: T) => {\n    const authError = await basicAuth(request);\n    if (authError) {\n      return authError;\n    }\n    return handler(request, ...args);\n  };\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAGO,eAAe,UAAU,OAAoB;IAClD,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;IAEvC,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,CAAC,WAAW;QACnD,OAAO,IAAI,gJAAY,CAAC,2BAA2B;YACjD,QAAQ;YACR,SAAS;gBACP,oBAAoB;YACtB;QACF;IACF;IAEA,MAAM,oBAAoB,WAAW,KAAK,CAAC,IAAI,CAAC,EAAE;IAClD,MAAM,cAAc,OAAO,IAAI,CAAC,mBAAmB,UAAU,QAAQ,CAAC;IACtE,MAAM,CAAC,UAAU,SAAS,GAAG,YAAY,KAAK,CAAC;IAE/C,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IACpD,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IAEpD,2EAA2E;IAC3E,IAAI,aAAa,iBAAiB,aAAa,eAAe;QAC5D,OAAO,MAAM,4BAA4B;IAC3C;IAEA,OAAO,IAAI,gJAAY,CAAC,uBAAuB;QAC7C,QAAQ;QACR,SAAS;YACP,oBAAoB;QACtB;IACF;AACF;AAEO,SAAS,YACd,OAAgE;IAEhE,OAAO,OAAO,SAAsB,GAAG;QACrC,MAAM,YAAY,MAAM,UAAU;QAClC,IAAI,WAAW;YACb,OAAO;QACT;QACA,OAAO,QAAQ,YAAY;IAC7B;AACF"}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///home/user/webapp/lib/db.ts"],"sourcesContent":["import { Pool, QueryResult, QueryResultRow } from 'pg';\n\nlet pool: Pool | null = null;\n\nexport function getDatabase(): Pool {\n  if (!pool) {\n    pool = new Pool({\n      connectionString: process.env.DATABASE_URL,\n      max: 20,\n      idleTimeoutMillis: 30000,\n      connectionTimeoutMillis: 2000,\n    });\n  }\n  return pool;\n}\n\nexport async function query<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<QueryResult<T>> {\n  const db = getDatabase();\n  return db.query<T>(text, params);\n}\n\nexport async function getOne<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<T | null> {\n  const result = await query<T>(text, params);\n  return result.rows[0] || null;\n}\n\nexport async function getAll<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<T[]> {\n  const result = await query<T>(text, params);\n  return result.rows;\n}\n\nexport async function insert<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<T> {\n  const result = await query<T>(text, params);\n  return result.rows[0];\n}\n\nexport async function update<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<T | null> {\n  const result = await query<T>(text, params);\n  return result.rows[0] || null;\n}\n\nexport async function remove(text: string, params?: any[]): Promise<boolean> {\n  const result = await query(text, params);\n  return result.rowCount !== null && result.rowCount > 0;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;;;;;AAEA,IAAI,OAAoB;AAEjB,SAAS;IACd,IAAI,CAAC,MAAM;QACT,OAAO,IAAI,qJAAI,CAAC;YACd,kBAAkB,QAAQ,GAAG,CAAC,YAAY;YAC1C,KAAK;YACL,mBAAmB;YACnB,yBAAyB;QAC3B;IACF;IACA,OAAO;AACT;AAEO,eAAe,MACpB,IAAY,EACZ,MAAc;IAEd,MAAM,KAAK;IACX,OAAO,GAAG,KAAK,CAAI,MAAM;AAC3B;AAEO,eAAe,OACpB,IAAY,EACZ,MAAc;IAEd,MAAM,SAAS,MAAM,MAAS,MAAM;IACpC,OAAO,OAAO,IAAI,CAAC,EAAE,IAAI;AAC3B;AAEO,eAAe,OACpB,IAAY,EACZ,MAAc;IAEd,MAAM,SAAS,MAAM,MAAS,MAAM;IACpC,OAAO,OAAO,IAAI;AACpB;AAEO,eAAe,OACpB,IAAY,EACZ,MAAc;IAEd,MAAM,SAAS,MAAM,MAAS,MAAM;IACpC,OAAO,OAAO,IAAI,CAAC,EAAE;AACvB;AAEO,eAAe,OACpB,IAAY,EACZ,MAAc;IAEd,MAAM,SAAS,MAAM,MAAS,MAAM;IACpC,OAAO,OAAO,IAAI,CAAC,EAAE,IAAI;AAC3B;AAEO,eAAe,OAAO,IAAY,EAAE,MAAc;IACvD,MAAM,SAAS,MAAM,MAAM,MAAM;IACjC,OAAO,OAAO,QAAQ,KAAK,QAAQ,OAAO,QAAQ,GAAG;AACvD"}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///home/user/webapp/app/api/admin/events/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { requireAuth } from '@/lib/adminAuth';\nimport { getAll, insert, update } from '@/lib/db';\n\nasync function getHandler(request: NextRequest) {\n  try {\n    const events = await getAll(\n      `SELECT e.*, a.name as artist_name\n       FROM events e\n       LEFT JOIN artists a ON e.artist_id = a.id\n       ORDER BY e.created_at DESC`\n    );\n\n    return NextResponse.json(events);\n  } catch (error) {\n    console.error('Get events error:', error);\n    return NextResponse.json(\n      { error: 'Failed to fetch events' },\n      { status: 500 }\n    );\n  }\n}\n\nasync function postHandler(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const {\n      artistId,\n      title,\n      slug,\n      description,\n      thumbnailUrl,\n      streamUrl,\n      archiveUrl,\n      status,\n      startTime,\n      endTime,\n    } = body;\n\n    if (!artistId || !title || !slug) {\n      return NextResponse.json(\n        { error: 'Missing required fields' },\n        { status: 400 }\n      );\n    }\n\n    const event = await insert(\n      `INSERT INTO events (\n        artist_id, title, slug, description, thumbnail_url,\n        stream_url, archive_url, status, start_time, end_time\n      ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)\n      RETURNING *`,\n      [\n        artistId,\n        title,\n        slug,\n        description || null,\n        thumbnailUrl || null,\n        streamUrl || null,\n        archiveUrl || null,\n        status || 'upcoming',\n        startTime || null,\n        endTime || null,\n      ]\n    );\n\n    return NextResponse.json(event, { status: 201 });\n  } catch (error: any) {\n    console.error('Create event error:', error);\n    if (error.code === '23505') {\n      return NextResponse.json(\n        { error: 'Event with this slug already exists' },\n        { status: 409 }\n      );\n    }\n    return NextResponse.json(\n      { error: 'Failed to create event' },\n      { status: 500 }\n    );\n  }\n}\n\nexport const GET = requireAuth(getHandler);\nexport const POST = requireAuth(postHandler);\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;;;;AAEA,eAAe,WAAW,OAAoB;IAC5C,IAAI;QACF,MAAM,SAAS,MAAM,IAAA,qHAAM,EACzB,CAAC;;;iCAG0B,CAAC;QAG9B,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAyB,GAClC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEA,eAAe,YAAY,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACJ,QAAQ,EACR,KAAK,EACL,IAAI,EACJ,WAAW,EACX,YAAY,EACZ,SAAS,EACT,UAAU,EACV,MAAM,EACN,SAAS,EACT,OAAO,EACR,GAAG;QAEJ,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM;YAChC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,MAAM,IAAA,qHAAM,EACxB,CAAC;;;;iBAIU,CAAC,EACZ;YACE;YACA;YACA;YACA,eAAe;YACf,gBAAgB;YAChB,aAAa;YACb,cAAc;YACd,UAAU;YACV,aAAa;YACb,WAAW;SACZ;QAGH,OAAO,gJAAY,CAAC,IAAI,CAAC,OAAO;YAAE,QAAQ;QAAI;IAChD,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,IAAI,MAAM,IAAI,KAAK,SAAS;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsC,GAC/C;gBAAE,QAAQ;YAAI;QAElB;QACA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAyB,GAClC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,MAAM,MAAM,IAAA,iIAAW,EAAC;AACxB,MAAM,OAAO,IAAA,iIAAW,EAAC"}}]
}